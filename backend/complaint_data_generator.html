<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Customer Complaint Data Generator</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            backdrop-filter: blur(10px);
        }

        h1 {
            text-align: center;
            color: #333;
            margin-bottom: 30px;
            font-size: 2.5em;
            background: linear-gradient(45deg, #667eea, #764ba2);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .controls {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
            padding: 20px;
            background: rgba(255, 255, 255, 0.7);
            border-radius: 15px;
            border: 1px solid rgba(255, 255, 255, 0.3);
        }

        .control-group {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        label {
            font-weight: 600;
            color: #555;
            font-size: 0.95em;
        }

        input, select {
            padding: 12px;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            font-size: 1em;
            transition: all 0.3s ease;
            background: white;
        }

        input:focus, select:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .button-group {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin: 30px 0;
        }

        button {
            padding: 15px 30px;
            font-size: 1.1em;
            font-weight: 600;
            border: none;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .generate-btn {
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
        }

        .generate-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(102, 126, 234, 0.3);
        }

        .download-btn {
            background: linear-gradient(45deg, #56ab2f, #a8e6cf);
            color: white;
        }

        .download-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(86, 171, 47, 0.3);
        }

        .preview-container {
            margin-top: 30px;
            background: rgba(255, 255, 255, 0.9);
            border-radius: 15px;
            padding: 20px;
            border: 1px solid rgba(255, 255, 255, 0.3);
        }

        .stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }

        .stat-card {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            padding: 15px;
            border-radius: 10px;
            text-align: center;
        }

        .stat-number {
            font-size: 2em;
            font-weight: bold;
        }

        .stat-label {
            font-size: 0.9em;
            opacity: 0.9;
        }

        .table-container {
            max-height: 400px;
            overflow: auto;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            background: white;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            font-size: 0.9em;
        }

        th {
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
            padding: 12px 8px;
            text-align: left;
            position: sticky;
            top: 0;
            z-index: 10;
            font-weight: 600;
        }

        td {
            padding: 10px 8px;
            border-bottom: 1px solid #f0f0f0;
            max-width: 150px;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }

        tr:nth-child(even) {
            background-color: #f8f9fa;
        }

        tr:hover {
            background-color: #e8f2ff;
        }

        .loading {
            text-align: center;
            padding: 40px;
            color: #667eea;
        }

        .spinner {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #667eea;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .field-info {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
        }

        .field-info h3 {
            color: #333;
            margin-bottom: 10px;
        }

        .field-info p {
            color: #666;
            line-height: 1.5;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üè• Customer Complaint Data Generator</h1>
        
        <div class="field-info">
            <h3>Enhanced Features for ML Analysis</h3>
            <p>This generator creates realistic pharmaceutical complaint data with intelligent relationships between fields. 
            Additional features include complaint severity scoring, resolution time prediction, seasonal patterns, 
            age-based drug preferences, and geographic clustering for comprehensive machine learning analysis.</p>
        </div>

        <div class="controls">
            <div class="control-group">
                <label for="numRecords">Number of Records</label>
                <input type="number" id="numRecords" min="10" max="10000" value="1000">
            </div>
            
            <div class="control-group">
                <label for="startDate">Start Date</label>
                <input type="date" id="startDate" value="2024-01-01">
            </div>
            
            <div class="control-group">
                <label for="endDate">End Date</label>
                <input type="date" id="endDate" value="2024-12-31">
            </div>
            
            <div class="control-group">
                <label for="severityDist">Severity Distribution</label>
                <select id="severityDist">
                    <option value="realistic">Realistic (Most Low-Medium)</option>
                    <option value="uniform">Uniform Distribution</option>
                    <option value="critical-heavy">Critical-Heavy</option>
                </select>
            </div>
            
            <div class="control-group">
                <label for="seasonalPattern">Seasonal Patterns</label>
                <select id="seasonalPattern">
                    <option value="true">Include Seasonal Effects</option>
                    <option value="false">Random Distribution</option>
                </select>
            </div>
            
            <div class="control-group">
                <label for="outputFormat">Output Format</label>
                <select id="outputFormat">
                    <option value="csv">CSV</option>
                    <option value="json">JSON</option>
                </select>
            </div>
        </div>

        <div class="button-group">
            <button class="generate-btn" onclick="generateData()">Generate Data</button>
            <button class="download-btn" onclick="downloadData()" id="downloadBtn" style="display: none;">Download Dataset</button>
        </div>

        <div id="previewContainer" class="preview-container" style="display: none;">
            <div class="stats" id="stats"></div>
            <div class="table-container">
                <table id="previewTable">
                    <thead id="tableHead"></thead>
                    <tbody id="tableBody"></tbody>
                </table>
            </div>
        </div>
    </div>

    <script>
        let generatedData = [];
        
        // Enhanced field definitions with ML-friendly features
        const drugClasses = [
            'Cardiovascular', 'Endocrine', 'Respiratory', 'Gastrointestinal', 
            'Neurological', 'Oncology', 'Immunology', 'Dermatology'
        ];
        
        const drugSubClasses = {
            'Cardiovascular': ['ACE Inhibitors', 'Beta Blockers', 'Diuretics', 'Statins'],
            'Endocrine': ['Insulin', 'Thyroid Hormones', 'Corticosteroids', 'Diabetes Oral'],
            'Respiratory': ['Bronchodilators', 'Inhaled Steroids', 'Antihistamines', 'Cough Suppressants'],
            'Gastrointestinal': ['Proton Pump Inhibitors', 'Antacids', 'Laxatives', 'Anti-diarrheals'],
            'Neurological': ['Anticonvulsants', 'Antidepressants', 'Pain Relievers', 'Sedatives'],
            'Oncology': ['Chemotherapy', 'Targeted Therapy', 'Immunotherapy', 'Hormone Therapy'],
            'Immunology': ['Immunosuppressants', 'Biologics', 'Vaccines', 'Allergy Medications'],
            'Dermatology': ['Topical Steroids', 'Antifungals', 'Acne Treatments', 'Moisturizers']
        };
        
        const brandNames = [
            'Mediflex', 'Healquick', 'Vitacore', 'Pharmagen', 'Biocure', 'Lifesafe', 
            'Wellness Pro', 'Health Plus', 'MediCare', 'BioPharm', 'TherapyMax', 'CureWell'
        ];
        
        const manufacturers = [
            'PharmaCorp Inc', 'BioChem Industries', 'MediTech Solutions', 'Global Health Labs',
            'Advanced Pharma', 'Life Sciences Co', 'Therapeutic Systems', 'BioMed Corporation'
        ];
        
        const countries = ['USA', 'India', 'Canada', 'UK', 'Germany', 'Australia', 'France', 'Japan'];
        const statesByCountry = {
            'USA': ['California', 'Texas', 'Florida', 'New York', 'Illinois', 'Pennsylvania', 'Ohio', 'Georgia'],
            'India': ['Maharashtra', 'Delhi', 'Karnataka', 'Gujarat', 'Tamil Nadu', 'West Bengal', 'Rajasthan'],
            'Canada': ['Ontario', 'Quebec', 'British Columbia', 'Alberta', 'Manitoba', 'Saskatchewan'],
            'UK': ['England', 'Scotland', 'Wales', 'Northern Ireland'],
            'Germany': ['Bavaria', 'North Rhine-Westphalia', 'Baden-W√ºrttemberg', 'Lower Saxony'],
            'Australia': ['New South Wales', 'Victoria', 'Queensland', 'Western Australia'],
            'France': ['√éle-de-France', 'Provence-Alpes-C√¥te d\'Azur', 'Auvergne-Rh√¥ne-Alpes'],
            'Japan': ['Tokyo', 'Osaka', 'Kanagawa', 'Aichi', 'Saitama', 'Chiba']
        };
        
        const complaintModes = ['Phone', 'Email', 'Web', 'Post', 'Fax'];
        const complaintStatuses = ['Ongoing', 'Resolved', 'Hold', 'Escalated'];
        const administrationModes = ['Oral', 'Tablet', 'Injection', 'Topical', 'Inhaler', 'IV', 'Patch'];
        
        // ML-friendly complaint templates
        const complaintTemplates = {
            'Side Effect': [
                'Experiencing {severity} {symptom} after taking {drug}',
                'Developed {symptom} within {timeframe} of starting medication',
                'Unexpected {symptom} reaction to prescribed {drug}'
            ],
            'Efficacy Issue': [
                'Medication not working as expected for {condition}',
                'No improvement in {condition} after {timeframe} of treatment',
                'Previous medication was more effective than current {drug}'
            ],
            'Packaging Problem': [
                'Cannot open medicine bottle - safety cap too difficult',
                'Pills arrived damaged in packaging',
                'Bottle leaked during shipping causing medication damage'
            ],
            'Dosage Confusion': [
                'Unclear dosage instructions on label',
                'Prescribed dosage differs from package instructions',
                'Accidentally took wrong dose due to confusing labeling'
            ],
            'Quality Issue': [
                'Pills appear different color/shape than usual',
                'Medicine has unusual odor or taste',
                'Received expired medication from pharmacy'
            ]
        };
        
        const symptoms = ['nausea', 'dizziness', 'headache', 'rash', 'fatigue', 'insomnia', 'stomach pain', 'muscle aches'];
        const severityLevels = ['mild', 'moderate', 'severe'];
        const timeframes = ['1 day', '3 days', '1 week', '2 weeks', '1 month'];
        const conditions = ['hypertension', 'diabetes', 'arthritis', 'depression', 'asthma', 'allergies'];

        function randomChoice(arr) {
            return arr[Math.floor(Math.random() * arr.length)];
        }

        function randomInt(min, max) {
            return Math.floor(Math.random() * (max - min + 1)) + min;
        }

        function generateRandomDate(start, end) {
            return new Date(start.getTime() + Math.random() * (end.getTime() - start.getTime()));
        }

        function formatDate(date) {
            return date.toISOString().slice(0, 19).replace('T', ' ');
        }

        function generateComplaintDescription(complaintType) {
            const templates = complaintTemplates[complaintType];
            const template = randomChoice(templates);
            
            return template
                .replace('{severity}', randomChoice(severityLevels))
                .replace('{symptom}', randomChoice(symptoms))
                .replace('{drug}', randomChoice(brandNames))
                .replace('{timeframe}', randomChoice(timeframes))
                .replace('{condition}', randomChoice(conditions));
        }

        function calculateSeverityScore(status, mode, drugClass, ageGroup) {
            let score = Math.random() * 100;
            
            // Adjust based on status
            if (status === 'Escalated') score += 30;
            else if (status === 'Hold') score += 15;
            
            // Adjust based on mode (urgent modes get higher scores)
            if (mode === 'Phone') score += 10;
            else if (mode === 'Web') score += 5;
            
            // Certain drug classes are more critical
            if (['Oncology', 'Cardiovascular'].includes(drugClass)) score += 20;
            
            // Age factor
            if (ageGroup === 'Senior') score += 15;
            else if (ageGroup === 'Pediatric') score += 10;
            
            return Math.min(100, Math.max(0, Math.round(score)));
        }

        function getAgeGroup(dob) {
            const age = new Date().getFullYear() - dob.getFullYear();
            if (age < 18) return 'Pediatric';
            else if (age >= 65) return 'Senior';
            else return 'Adult';
        }

        function generateData() {
            const numRecords = parseInt(document.getElementById('numRecords').value);
            const startDate = new Date(document.getElementById('startDate').value);
            const endDate = new Date(document.getElementById('endDate').value);
            const severityDist = document.getElementById('severityDist').value;
            const seasonalPattern = document.getElementById('seasonalPattern').value === 'true';

            // Show loading
            document.getElementById('previewContainer').innerHTML = '<div class="loading"><div class="spinner"></div>Generating realistic complaint data...</div>';
            document.getElementById('previewContainer').style.display = 'block';

            setTimeout(() => {
                generatedData = [];
                const complaintTypes = Object.keys(complaintTemplates);
                
                for (let i = 0; i < numRecords; i++) {
                    // Generate customer demographics
                    const customerId = i + 1;
                    const customerDob = new Date(1940 + Math.random() * 70, Math.floor(Math.random() * 12), Math.floor(Math.random() * 28));
                    const ageGroup = getAgeGroup(customerDob);
                    const country = randomChoice(countries);
                    const state = randomChoice(statesByCountry[country]);
                    const zip = String(randomInt(10000, 99999));
                    
                    // Generate drug information with relationships
                    const drugClass = randomChoice(drugClasses);
                    const drugSubClass = randomChoice(drugSubClasses[drugClass]);
                    const brandName = randomChoice(brandNames);
                    const manufacturer = randomChoice(manufacturers);
                    const batchCode = randomInt(1000, 9999);
                    const administration = randomChoice(administrationModes);
                    
                    // Generate complaint details
                    const complaintId = randomInt(1, 1000);
                    const complaintSeq = randomInt(1, 5);
                    
                    let interactionDate = generateRandomDate(startDate, endDate);
                    
                    // Add seasonal patterns if enabled
                    if (seasonalPattern) {
                        const month = interactionDate.getMonth();
                        // More complaints in winter months (flu season) and spring (allergy season)
                        if (month >= 10 || month <= 2 || (month >= 3 && month <= 5)) {
                            if (Math.random() < 0.3) {
                                interactionDate = generateRandomDate(startDate, endDate);
                            }
                        }
                    }
                    
                    const mode = randomChoice(complaintModes);
                    const complaintType = randomChoice(complaintTypes);
                    const shortDesc = complaintType;
                    const longDesc = generateComplaintDescription(complaintType);
                    
                    // Generate narrative chain
                    const narrativeChain = `${formatDate(interactionDate)}: [Agent ${randomInt(1, 150)}] ${randomChoice(['Received call from patient', 'Email received from customer', 'Web form submitted', 'Letter received'])}.\n\n${formatDate(new Date(interactionDate.getTime() + randomInt(1, 60) * 60000))}: ${longDesc}`;
                    
                    let status = randomChoice(complaintStatuses);
                    
                    // Adjust status based on severity distribution
                    if (severityDist === 'critical-heavy') {
                        status = Math.random() < 0.4 ? 'Escalated' : status;
                    }
                    
                    const complaintCode = drugClass;
                    const relatedDelivery = randomInt(0, 5);
                    
                    // Generate responses
                    const agentResponses = [
                        'Issue acknowledged and escalated to medical team',
                        'Patient education provided regarding side effects',
                        'Referred to pharmacist for medication review',
                        'Follow-up appointment scheduled',
                        'Prescription adjustment recommended'
                    ];
                    const agentL1 = randomChoice(agentResponses);
                    
                    const companyResponses = [
                        'Company is investigating the reported issue',
                        'Standard side effect profile - monitoring advised',
                        'Quality control measures being reviewed',
                        'Patient counseling materials being updated',
                        'Batch testing results show no quality issues'
                    ];
                    const companyResponse = randomChoice(companyResponses);
                    
                    const dispute = Math.random() < 0.2 ? 'Yes' : 'No';
                    const consent = Math.random() < 0.8 ? 'Yes' : 'No';
                    
                    // Calculate additional ML features
                    const severityScore = calculateSeverityScore(status, mode, drugClass, ageGroup);
                    const resolutionDays = status === 'Resolved' ? randomInt(1, 30) : null;
                    const followupRequired = severityScore > 70 || status === 'Escalated' ? 'Yes' : 'No';
                    const riskCategory = severityScore > 80 ? 'High' : severityScore > 50 ? 'Medium' : 'Low';
                    
                    // Priority scoring for ML
                    let priorityScore = severityScore;
                    if (ageGroup === 'Senior' || ageGroup === 'Pediatric') priorityScore += 10;
                    if (drugClass === 'Oncology') priorityScore += 15;
                    if (mode === 'Phone') priorityScore += 5;
                    
                    const record = {
                        customer_id: customerId,
                        customer_dob: formatDate(customerDob),
                        customer_country: country,
                        customer_state: state,
                        customer_zip: zip,
                        customer_age_group: ageGroup,
                        
                        complaint_id: complaintId,
                        complaint_id_seq: complaintSeq,
                        complaint_interaction_date: formatDate(interactionDate),
                        complaint_mode: mode,
                        complaint_desc_short: shortDesc,
                        complaint_desc: longDesc,
                        complaint_desc_narrative: longDesc + ` Patient has been taking ${brandName} for ${randomChoice(['2 weeks', '1 month', '3 months', '6 months'])}.`,
                        complaint_narrative_chain: narrativeChain,
                        complaint_status: status,
                        complaint_code: complaintCode,
                        complaint_related_delivery: relatedDelivery,
                        complaint_type: complaintType,
                        
                        drug_class: drugClass,
                        drug_sub_class: drugSubClass,
                        drug_brand_name: brandName,
                        manufacturer: manufacturer,
                        drug_batch_code: batchCode,
                        drug_administration: administration,
                        
                        agent_l1: agentL1,
                        company_response: companyResponse,
                        customer_dispute: dispute,
                        consent: consent,
                        
                        // Additional ML features
                        severity_score: severityScore,
                        priority_score: Math.min(100, priorityScore),
                        resolution_days: resolutionDays,
                        followup_required: followupRequired,
                        risk_category: riskCategory,
                        interaction_hour: interactionDate.getHours(),
                        interaction_day_of_week: interactionDate.getDay(),
                        interaction_month: interactionDate.getMonth() + 1,
                        days_since_interaction: Math.floor((new Date() - interactionDate) / (1000 * 60 * 60 * 24))
                    };
                    
                    generatedData.push(record);
                }
                
                displayPreview();
                document.getElementById('downloadBtn').style.display = 'inline-block';
            }, 1000);
        }

        function displayPreview() {
            const container = document.getElementById('previewContainer');
            
            // Generate statistics
            const stats = calculateStats();
            const statsHtml = `
                <div class="stat-card">
                    <div class="stat-number">${generatedData.length}</div>
                    <div class="stat-label">Total Records</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number">${stats.avgSeverity}%</div>
                    <div class="stat-label">Avg Severity</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number">${stats.escalatedPct}%</div>
                    <div class="stat-label">Escalated</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number">${stats.uniqueCustomers}</div>
                    <div class="stat-label">Unique Customers</div>
                </div>
            `;
            
            // Generate table preview (first 10 records)
            const headers = Object.keys(generatedData[0]);
            const headerHtml = headers.map(h => `<th>${h}</th>`).join('');
            const rowsHtml = generatedData.slice(0, 10).map(record => {
                return `<tr>${headers.map(h => `<td title="${record[h]}">${record[h]}</td>`).join('')}</tr>`;
            }).join('');
            
            container.innerHTML = `
                <div class="stats">${statsHtml}</div>
                <div class="table-container">
                    <table id="previewTable">
                        <thead><tr>${headerHtml}</tr></thead>
                        <tbody>${rowsHtml}</tbody>
                    </table>
                </div>
                <p style="text-align: center; margin-top: 15px; color: #666;">
                    Showing first 10 records of ${generatedData.length} generated records
                </p>
            `;
        }

        function calculateStats() {
            const totalSeverity = generatedData.reduce((sum, record) => sum + record.severity_score, 0);
            const escalated = generatedData.filter(record => record.complaint_status === 'Escalated').length;
            const uniqueCustomers = new Set(generatedData.map(record => record.customer_id)).size;
            
            return {
                avgSeverity: Math.round(totalSeverity / generatedData.length),
                escalatedPct: Math.round((escalated / generatedData.length) * 100),
                uniqueCustomers: uniqueCustomers
            };
        }

        function downloadData() {
            const format = document.getElementById('outputFormat').value;
            
            if (format === 'csv') {
                downloadCSV();
            } else {
                downloadJSON();
            }
        }

        function downloadCSV() {
            const headers = Object.keys(generatedData[0]);
            const csvContent = [
                headers.join(','),
                ...generatedData.map(record => 
                    headers.map(header => {
                        const value = record[header];
                        return typeof value === 'string' && value.includes(',') ? `"${value}"` : value;
                    }).join(',')
                )
            ].join('\n');
            
            const blob = new Blob([csvContent], { type: 'text/csv' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `customer_complaints_${generatedData.length}_records.csv`;
            a.click();
            URL.revokeObjectURL(url);
        }

        function downloadJSON() {
            const jsonContent = JSON.stringify(generatedData, null, 2);
            const blob = new Blob([jsonContent], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `customer_complaints_${generatedData.length}_records.json`;
            a.click();
            URL.revokeObjectURL(url);
        }

        // Set default end date to today
        document.getElementById('endDate').value = new Date().toISOString().split('T')[0];
    </script>
</body>
</html>